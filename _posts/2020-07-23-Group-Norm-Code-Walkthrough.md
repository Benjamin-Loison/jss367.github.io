---
layout: post
title: "Group Norm Code Walkthrough"
description: "A post that walks thorugh how the code behind group norm works."
feature-img: "assets/img/rainbow.jpg"
thumbnail: "assets/img/woodswallow_group.jpg"
tags: [TensorFlow, Deep Learning]
---

In the paper [Group Normalization](https://arxiv.org/abs/1803.08494) by Yuxin Wu and Kaiming He, they introduce the idea of group normalization. They also show that it can be applied very easily by including the necessary code. This post walks through the code behind group normalization.


```python
import numpy as np
import tensorflow as tf
```

Let's start with a random tensor. We'll say that we're somewhere inside the network and at this point we have images that are 112 X 112 and a depth of 16. We'll also say we're working with batches of size 64. Using the order N * C * H * W, our tensor would like like this:


```python
tensor = np.random.random((64, 16, 112, 112))
```


```python
type(tensor)
```




    numpy.ndarray




```python
tensor.shape
```




    (64, 16, 112, 112)



Let's extract the different components from the tensor shape because we'll need to manipulate them later on.


```python
N, C, H, W = tensor.shape
```

To implement group norm, we'll need a group size. This is the number of channels that we're grouping together into a normalization group. The number of input channels (16 in this case) needs to be evenly divisible by this number. We'll choose 4 as our number.


```python
G = 4
```

Now we need to reshape our tensor, adding a dimension for the group number. The first dimension is the batch size and remains unchanged, the second is the group size, the third is the number of groups (C // G), and the fourth and fifth are height and width, respectively.


```python
tensor = tf.reshape(tensor, [N, G, C // G, H, W])
```

Let's look at what those values are.


```python
[N, G, C // G, H, W]
```




    [64, 4, 4, 112, 112]



Note that now that we've used TensorFlow to reshape our tensor, it's no longer a numpy array. Now it's a Tensorflow EagerTensor.


```python
type(tensor)
```




    tensorflow.python.framework.ops.EagerTensor



Now we need to calculate the moments. The first moment of a probability distribution is the mean (expected value) and the second moment is the variance. Then we need to decide which axes to calculate the moments around. Each batch and group are going to have separate normalization parameters, so we don't want to include those along the axes in the normalization. We want to calculate them along the width, height, and the number of channels in our group.

This image from the Group Normalization paper illustrates that. In this illustration, the group size would be three, as you can see three highlighted blocks along the channel dimension.

![Group Norm]({{site.baseurl}}/assets/img/group_norm.png "Group Norm")

TensorFlow has a built in capability to calcuate moments, `tf.nn.moments`. It will return two objects with shape (in this case) 64, 4, 1, 1, 1. The first is the mean and the second is the variance.


```python
mean, var = tf.nn.moments(tensor, [2, 3, 4], keepdims=True)
```

Now we use those values to normalize the group. The epsilon value is just there to avoid a divide by zero error. It's 1e-5 in the original paper and in PyTorch, but 1e-3 in TensorFlow. The exact value shouldn't actually matter.


```python
tensor = (tensor-mean) / (var + 1e-5)
```

Then we put it back into the original shape.


```python
tensor = tf.reshape(tensor, [N, C, H, W])
```

Then, and this is very important, we include the scaling and shifting factors. Just like in batch norm, we multiply by the scale then add the shift factor. These are learnable parameters, but to start with you can set `gamma` to 1 and `beta` to 0 so they act as an identity function.


```python
gamma = 1
beta = 0
```


```python
tensor = tensor * gamma + beta
```


```python
tensor
```




    <tf.Tensor: shape=(64, 16, 112, 112), dtype=float64, numpy=
    array([[[[ 1.49371742,  5.65688153, -1.88246888, ..., -0.15842722,
              -4.79418743,  0.01217693],
             [ 2.1728747 ,  0.45236571, -5.718506  , ..., -0.59863429,
               2.30373147,  2.46250741],
             [-1.65287343,  0.4271968 ,  4.06258827, ..., -1.43036657,
              -0.95255935,  0.67078677],
             ...,
             [ 4.58817278,  2.17978044, -2.32176479, ..., -1.62743325,
              -1.24164504,  3.86022068],
             [ 5.23774156,  0.72634789,  2.07676819, ..., -2.00491596,
               5.11442316,  1.11097318],
             [ 4.40410735,  5.30360644,  1.78733839, ..., -3.05217587,
              -4.11119125, -4.16168332]],
    
            [[-0.05307989,  4.43310146,  2.26043662, ..., -4.84572658,
              -3.46771079,  0.58274132],
             [-1.15624714, -5.11184688, -0.51810624, ..., -3.73663046,
              -0.24112088,  1.91400668],
             [ 0.04339517,  5.14350526, -5.17220574, ...,  4.51886704,
              -1.62221828,  1.01042926],
             ...,
             [ 2.56675205, -1.97859149, -2.91148701, ..., -3.76345504,
               4.9214182 , -2.55599055],
             [-2.38703796, -1.48613954, -5.3992382 , ...,  4.59857272,
              -0.24266246, -5.35610175],
             [-2.74662545, -0.99088991, -1.02727777, ...,  4.01129893,
               5.14230342,  5.15596755]],
    
            [[ 1.24207402, -4.27581581,  5.55119753, ..., -3.31840422,
              -1.52512412,  4.45198942],
             [-2.31485385, -0.20928536, -2.62718884, ...,  5.02787061,
               2.39087295,  5.51466663],
             [ 2.72808103, -5.22351165, -4.94990759, ...,  5.58491447,
               2.88915789, -5.43049465],
             ...,
             [ 5.1195128 , -4.60253201, -1.59736234, ..., -5.37483524,
               2.81252776, -2.93665146],
             [ 0.46562288,  1.84735521,  0.81363506, ...,  3.71924712,
               2.16499287,  3.01753422],
             [ 2.47347263,  1.88358995,  2.19803107, ...,  5.54463834,
               5.98486455, -4.79527955]],
    
            ...,
    
            [[ 0.95900564, -1.38046463, -4.73996089, ...,  3.06343795,
               0.38037784, -4.05864559],
             [-4.85811974,  4.39699529, -1.67975015, ..., -2.67953293,
              -2.09708606,  3.48858204],
             [-5.34864845, -2.58713071,  0.10792731, ..., -5.07085447,
               0.11549627, -4.18447536],
             ...,
             [ 2.18926656, -2.75229463, -3.7771427 , ...,  3.25392889,
              -4.50773419,  3.82247501],
             [-2.78444703,  4.26099768, -5.67490654, ..., -4.17754857,
               0.93282837, -2.98796521],
             [-2.21360432, -5.84320923,  2.53519775, ..., -0.28470847,
               1.51734112, -0.46144922]],
    
            [[ 5.11928955,  5.44142857, -0.17805463, ..., -4.84961543,
              -4.10921173, -3.75452511],
             [ 3.91991808,  5.23396084,  0.56423018, ...,  2.13410004,
               3.4325136 , -1.61478835],
             [ 1.60158375, -2.63385088,  3.61096249, ..., -5.28920009,
               5.36380743,  1.97782298],
             ...,
             [-1.75584906,  2.3386676 , -3.14400484, ...,  3.34641663,
              -4.70301907, -2.91222714],
             [-2.70412388, -4.3860121 , -5.04114754, ...,  0.76046897,
               4.73279645,  0.77005539],
             [-4.20912355, -3.989095  , -1.63070859, ...,  1.98472754,
              -5.52038187, -2.73875843]],
    
            [[-3.09404905, -0.76753686,  3.35562144, ...,  4.57020585,
              -0.48991316, -5.77811194],
             [-5.8337319 , -2.29964199, -1.88767053, ...,  4.55342756,
               3.92818131,  2.64172928],
             [ 3.97898348, -4.21373804,  4.84246595, ...,  4.80751886,
              -5.53809521, -1.18619073],
             ...,
             [-5.30737469,  5.17319991, -2.81835093, ...,  4.42018254,
               5.48691878,  3.41386046],
             [ 3.33408589, -1.76980245, -5.51433036, ...,  3.54062089,
               3.47539265,  2.68578291],
             [-0.01548558,  1.63789625,  5.05892996, ..., -1.09330985,
               3.4736073 , -1.64356953]]],
    
    
           [[[ 4.6411865 ,  5.00151402,  0.00840432, ..., -3.6022827 ,
              -4.26829452, -2.52924139],
             [-5.24850844, -4.95014674, -3.78748781, ...,  0.97287747,
              -4.93235325, -1.2755362 ],
             [ 4.21086219, -1.36653757,  2.86067544, ...,  3.32646688,
               3.75826776, -4.60732073],
             ...,
             [-4.71296159, -0.86932152,  5.91888536, ...,  4.18670614,
               2.52785938,  3.95423631],
             [-4.83962716,  1.07209807, -5.6436475 , ..., -4.80920944,
               5.29574985, -1.52805083],
             [ 0.82062579, -3.40062373,  3.05762228, ..., -4.39769425,
               5.13281341,  4.71719611]],
    
            [[ 3.5477641 ,  4.82952381, -4.59008906, ...,  0.29104831,
               0.52359375,  4.26006655],
             [ 5.26785756,  2.5945716 , -1.74873563, ...,  3.82828477,
               3.61817118,  4.53264153],
             [ 4.24240015, -0.67343226,  1.57018949, ..., -3.82564374,
              -4.15198353, -1.57439046],
             ...,
             [ 1.35009788, -3.11002605,  3.38424442, ..., -3.7851081 ,
              -1.63112009,  3.57710115],
             [ 0.27533947, -2.75648601, -4.38458883, ..., -4.50569193,
               1.35998322, -4.56308298],
             [ 3.14091476,  4.84754268,  1.97235321, ...,  5.89191272,
               0.65861077,  4.93739484]],
    
            [[-0.07552433, -5.29601872,  4.80605197, ...,  1.01028346,
               1.9269121 ,  4.74336817],
             [-5.47922088,  3.47085312,  3.18591022, ...,  3.1794677 ,
              -1.84722341, -0.80198925],
             [ 4.42938774, -3.4293363 ,  4.8352135 , ...,  4.47356367,
              -2.39808249,  2.77340283],
             ...,
             [-1.13809459,  1.79033022,  2.37496626, ..., -1.74827558,
              -0.80464271,  5.58231112],
             [ 5.0369023 ,  2.32585735,  0.59139362, ...,  2.59675391,
              -0.0711668 ,  1.79740533],
             [-4.0922266 , -1.51791505,  3.91317089, ..., -0.15043398,
               3.60186328, -4.17267703]],
    
            ...,
    
            [[ 0.05756848, -2.16636629,  3.39970403, ..., -2.44756731,
               2.66493757,  2.189531  ],
             [ 5.15712236,  3.28969943, -5.17209977, ..., -1.58157887,
               4.68372182,  1.65388904],
             [-3.62965547,  1.93559856, -4.43331228, ...,  0.34095621,
              -5.62391842, -5.33970292],
             ...,
             [-4.52700052, -2.21314931,  4.91523493, ..., -3.6649782 ,
               5.70765184,  3.22783286],
             [ 2.63666714, -5.05678997, -2.22991268, ...,  1.64551953,
              -2.59758199, -5.99953516],
             [-4.60063814,  4.20915083, -3.92779746, ..., -2.64641725,
              -4.88317812,  4.60545523]],
    
            [[-1.05335725, -0.77168141,  3.96252146, ...,  1.91465258,
              -1.79342501,  4.02511043],
             [ 5.36386284, -5.01732977,  4.3091253 , ...,  1.88712807,
               4.01054315, -3.93866395],
             [ 4.20751309,  1.33947427, -2.36291239, ..., -0.9457146 ,
              -1.04664727,  4.54395378],
             ...,
             [-3.25069875, -3.16771802,  4.48840096, ..., -0.49931435,
               4.51990451, -4.4814688 ],
             [ 5.03663545, -3.86052506,  0.74693925, ...,  0.75813499,
               1.57881046, -0.58278374],
             [-0.59394391,  3.70257295, -5.46659238, ...,  3.27029012,
               3.94310012, -1.9677327 ]],
    
            [[-2.39536806, -5.37914646, -0.31361938, ...,  0.83515367,
               0.88544738,  4.40200237],
             [-4.4577185 ,  5.35963549,  4.0468476 , ...,  4.29650026,
               4.26096406, -4.7792328 ],
             [-5.59050171, -0.46189595,  5.79558102, ..., -3.1440278 ,
               2.34524074, -4.77569059],
             ...,
             [ 1.13324679, -3.86042241,  0.89941608, ..., -3.07846958,
               1.34853501,  5.86796764],
             [-0.63275728,  2.60577908, -5.26084631, ...,  1.18343805,
              -4.33861956,  3.44085277],
             [ 5.38708502, -4.6671686 ,  5.81753904, ..., -4.50032954,
              -4.32720747,  1.66313461]]],
    
    
           [[[-1.12029112,  1.27772287,  3.3985244 , ..., -1.39259794,
              -1.72651904, -0.23653853],
             [ 4.32158423,  2.80195718,  2.38850982, ..., -3.40270953,
              -5.02680385,  4.05639468],
             [-5.77437308, -2.5602029 ,  0.01414695, ...,  4.06678041,
              -3.57675716,  1.94407249],
             ...,
             [ 5.19122717, -4.98817187,  1.82769619, ...,  2.44758584,
               3.18427268, -0.20421977],
             [ 1.68423681, -1.88592378,  5.83546296, ...,  1.10063337,
               2.28321796,  2.20963199],
             [ 3.29644244,  1.89580936, -5.32883145, ..., -2.98422008,
               5.00058429, -0.1430417 ]],
    
            [[-3.02273862,  4.44790599,  3.65748889, ..., -5.64806276,
               5.60361129,  1.30011786],
             [-0.42751389, -2.29357435,  0.72563042, ...,  3.12793914,
               1.65653362,  3.98073347],
             [ 1.34956416, -3.15612462,  0.85883291, ...,  4.48897689,
               0.72653969,  4.53364941],
             ...,
             [-0.12791301, -5.90608156, -0.47906903, ...,  3.22431725,
               5.04028501, -3.17741747],
             [ 3.84359206,  3.05281502, -4.33615353, ..., -3.7170711 ,
               4.02900666,  5.69279205],
             [ 4.5471734 ,  4.18981712, -0.15892058, ...,  2.53926788,
              -5.87000251, -1.40016181]],
    
            [[ 5.42363068, -5.0481599 ,  0.51005162, ..., -1.29729547,
               2.73213045, -3.9103684 ],
             [-3.31906398,  3.65453472, -4.14502065, ...,  2.53492338,
               5.2847566 ,  0.99623488],
             [ 2.80886042,  1.91544274, -4.89249935, ...,  2.2969868 ,
               0.65143908, -1.21353376],
             ...,
             [-5.73453847, -4.74631839, -3.89474033, ...,  3.27055291,
               2.76106118,  4.55707269],
             [-5.37907865,  4.23388744,  4.63492772, ..., -2.23277632,
               3.52345893, -1.82177848],
             [-3.45328816, -3.90530388,  5.30888183, ...,  4.43089148,
               0.45475606,  0.17692251]],
    
            ...,
    
            [[ 2.96682226,  5.12216422, -1.94331651, ..., -3.78545444,
               1.66101831, -0.28239213],
             [-3.17498238, -2.35653896,  0.08314508, ...,  2.39133526,
               5.36866755,  0.62412738],
             [ 2.19729959,  5.32930246, -5.09212313, ...,  4.32858869,
               5.56937948, -4.65247853],
             ...,
             [ 0.97729184,  3.29069408,  4.02172207, ...,  1.39099731,
              -1.09247567,  4.08722686],
             [ 2.8426196 ,  2.29327005,  5.49610455, ...,  0.44407555,
              -0.63469973,  2.75367271],
             [ 0.3938543 , -2.92620361, -1.95222466, ...,  0.95883958,
              -0.53330439,  1.33160147]],
    
            [[ 0.69166484,  4.65108944,  2.21005175, ...,  2.76794056,
              -2.7719596 ,  1.33479248],
             [-5.53651578,  1.52060896,  3.3528619 , ..., -1.86624079,
               5.92862338, -1.55905923],
             [-2.48160744, -0.16212531, -0.88106885, ..., -5.59902084,
              -3.65677532, -3.49213949],
             ...,
             [ 1.44973089,  3.21148273,  3.86300672, ...,  5.28527977,
               1.41886784, -1.50800452],
             [ 3.10729642,  5.40011427,  1.01211959, ..., -2.15051081,
              -1.68700095,  2.16373224],
             [-2.30629799, -2.09121308,  1.11082801, ..., -3.56265455,
               2.08352894, -5.03102543]],
    
            [[ 4.08463068,  3.97487941, -5.61040552, ...,  0.67208698,
               2.73991556, -4.18071289],
             [ 5.30679384,  4.37604145, -0.41579089, ...,  5.02794726,
               5.2867389 ,  3.76479935],
             [ 5.26831526, -5.68712289, -5.90174386, ...,  4.27735924,
              -4.37530998, -3.59030675],
             ...,
             [-5.45546571,  4.85079159, -3.8647846 , ...,  3.70753176,
               2.74586436, -0.36051399],
             [-3.0876201 , -1.1668424 , -4.99871223, ..., -1.85166973,
               0.81279621, -5.64277208],
             [-5.30520202,  5.38563904,  3.46704952, ..., -3.57165529,
              -5.66622377,  3.1267441 ]]],
    
    
           ...,
    
    
           [[[-5.45361321,  4.45688227, -4.35646549, ...,  0.96895157,
              -2.73297012,  1.60186108],
             [-4.18267809, -3.64617885,  5.00620218, ..., -0.73434692,
              -4.3598462 ,  4.18223695],
             [-4.30260018, -0.79602065, -4.13216163, ...,  5.07998738,
               0.99717163,  3.68448188],
             ...,
             [ 5.71345789,  0.65479883, -3.00343048, ..., -1.55756239,
              -3.29817253,  1.63796341],
             [-0.25478181,  2.44148346, -3.76813238, ..., -4.663177  ,
              -1.24188034,  1.81230422],
             [ 3.5864191 , -3.08874058,  3.27597585, ...,  2.21446559,
               5.98767078,  4.04951807]],
    
            [[-0.41351637,  5.62511135,  5.77639081, ...,  3.21163154,
              -4.13666572, -5.30620292],
             [-4.48371407, -2.85730891, -2.401314  , ...,  2.68597733,
              -0.87036522,  5.20785685],
             [ 6.01544475,  2.71957872, -2.73882162, ...,  3.70531504,
               2.77593457,  0.39249704],
             ...,
             [ 4.34302778,  2.79488573,  0.87824813, ..., -5.54380572,
               0.20858189,  0.38631677],
             [ 2.2873865 ,  4.95602238, -1.16986717, ..., -2.86286841,
              -3.97485061,  2.77640563],
             [ 2.1557572 , -3.18119079,  3.60019381, ..., -5.7543107 ,
              -4.8792716 ,  0.74314141]],
    
            [[ 1.78817841, -3.64718116, -3.08237848, ..., -3.56472486,
               3.4185497 , -1.62516031],
             [-1.82317383, -5.23893971, -1.11292087, ..., -2.84418022,
               3.84506117,  1.85260844],
             [-3.43401437, -1.78658006,  2.54044448, ..., -1.04675893,
               0.24605266,  1.38830499],
             ...,
             [-1.15517407, -4.2693829 ,  1.80683652, ...,  2.04888055,
               5.14183059, -3.24008519],
             [-3.36953587,  5.95546588,  0.15100419, ..., -5.05046048,
               0.88378919,  5.52577302],
             [ 5.05700636, -3.5049729 , -1.95299971, ...,  4.86221284,
              -5.50235864,  5.57257778]],
    
            ...,
    
            [[-2.40179743,  5.71460444,  5.19999738, ...,  3.83605194,
               5.7229925 ,  3.93063769],
             [-5.96773393, -0.68790466,  1.94923631, ...,  0.10185627,
               2.09490803, -5.6083089 ],
             [-0.74873471,  4.14771153, -5.13206542, ...,  5.34834672,
              -4.44005523,  1.84712728],
             ...,
             [-1.01648073,  1.5228495 ,  0.16190573, ..., -3.2944114 ,
              -2.75953778,  3.53119746],
             [-0.16972297,  1.08231605, -4.44180608, ..., -2.846522  ,
               0.16883093, -2.30254505],
             [ 0.78429825,  5.36055977,  5.95117145, ..., -4.04792412,
               3.86127571,  5.00819899]],
    
            [[ 0.48747783, -1.58815654, -3.52425877, ...,  0.02967191,
              -4.39544814, -5.30691917],
             [ 3.11391946, -0.65994855,  2.74916626, ...,  4.27636797,
               0.72139422, -5.05434059],
             [ 0.63614399, -0.53477159,  3.68264781, ..., -5.27822998,
              -0.9662092 , -1.26208296],
             ...,
             [-5.6316967 , -0.69500956, -0.69362214, ..., -4.26017435,
               2.07585891, -1.08945093],
             [ 3.84690225, -3.86550727, -3.5417782 , ..., -0.24189012,
              -1.86295845, -3.78928288],
             [ 0.05116039,  3.60736767, -3.5672856 , ...,  4.24717057,
              -2.62161831,  3.03229986]],
    
            [[ 2.52745897, -3.78785589, -2.31168304, ...,  5.47625055,
              -3.19325067,  1.96794054],
             [-2.41446802, -4.9413993 ,  3.78282231, ...,  1.61364933,
               4.85874729, -3.27861376],
             [-4.37588975,  3.28493097, -3.48999398, ..., -0.57078855,
               1.41876396, -2.7138076 ],
             ...,
             [-1.32114653, -3.66588097,  3.83364883, ...,  2.7402366 ,
              -0.31791459,  3.30206925],
             [ 3.05675465,  3.76216314,  4.25936166, ...,  2.07483727,
              -5.19646282, -4.79238775],
             [-3.72462613, -5.90426182, -4.50603964, ...,  4.89144844,
               0.40353508,  3.72962914]]],
    
    
           [[[ 1.16882455, -1.68159633, -0.93317841, ...,  1.38161292,
               0.6802376 ,  4.83666581],
             [-2.53803591, -3.5944614 ,  3.02035294, ...,  4.30523951,
              -0.69505262,  2.14697399],
             [ 2.1960758 , -0.36140021,  5.93742764, ..., -2.20076601,
               3.03978971, -5.55843581],
             ...,
             [ 3.70854591, -0.11712034, -0.40727356, ...,  0.94107086,
              -5.48705857, -0.50376588],
             [ 1.80742601,  4.3168672 ,  5.77740855, ...,  4.65048256,
              -1.40127162, -5.39786792],
             [-5.82668362,  3.31320163,  4.80237176, ...,  4.80720021,
              -1.80073967, -1.03098779]],
    
            [[ 2.95693942,  0.22909994, -2.12981178, ...,  5.20499769,
               3.84568904,  0.33182038],
             [-2.77292949,  2.8563567 ,  3.80557492, ...,  2.79340317,
               4.63727291,  3.07009391],
             [-1.60256861,  1.64403375,  1.01952756, ..., -0.57740585,
               3.4737514 ,  2.4701366 ],
             ...,
             [-0.36397165,  3.50065345, -4.86837603, ..., -0.93276251,
               0.73782376,  5.41324954],
             [ 1.43129911, -5.88907099, -4.9984968 , ..., -1.20573319,
               4.08247229, -2.780208  ],
             [-2.85369432, -4.67014064,  2.45039792, ...,  5.49295486,
               0.72960363, -0.33162598]],
    
            [[ 2.297547  ,  1.79796311,  2.73052985, ..., -1.99869804,
               5.58438885, -2.46996205],
             [-0.78968971,  3.94233398,  1.48019286, ...,  0.81673102,
               0.10137625, -5.26807078],
             [-3.57971822, -0.72291105,  0.69519565, ..., -1.03686196,
              -5.31000334, -0.51883832],
             ...,
             [-4.50742327,  0.79045631, -5.83480403, ..., -2.43552133,
               0.46709091,  5.42707479],
             [-3.74876748, -5.27024176,  1.93312655, ..., -1.23721694,
              -2.95514314, -4.53173777],
             [-2.95151893, -3.43772141,  4.70378752, ...,  3.55507855,
               2.81137551,  3.86336024]],
    
            ...,
    
            [[-5.79878422, -3.62536587, -2.15769148, ...,  5.42891693,
               2.76912281, -0.6368429 ],
             [-2.05253311,  5.89093591,  0.2184465 , ..., -2.29560287,
              -5.08769695, -2.64983659],
             [-2.96645306, -3.71610838,  4.60205371, ..., -0.79324043,
               5.90003661,  0.87838573],
             ...,
             [-3.39754402,  5.17114531,  4.58961896, ..., -2.80150533,
              -2.68341339, -4.3779918 ],
             [-3.83330985,  3.91786541,  2.52793128, ...,  3.9196894 ,
              -5.96139417, -3.66334033],
             [-5.2003208 ,  0.74118981,  3.89345392, ...,  2.6728203 ,
               3.92315579, -1.15652919]],
    
            [[ 0.39461102, -0.20388948, -3.27593285, ..., -4.01682548,
              -4.1457369 , -2.6544868 ],
             [-4.91870603,  0.78017822,  1.55999403, ..., -5.60581965,
               2.64033199, -5.09037189],
             [-2.37533617,  1.56546586, -5.57331102, ..., -5.8527154 ,
               0.63829753,  0.1383492 ],
             ...,
             [ 2.47544015,  4.93170844,  3.17506862, ...,  1.47108496,
               3.81455172,  0.82150329],
             [ 2.67709176, -4.27806971,  5.60518982, ..., -2.51032572,
              -5.57154887, -3.91265803],
             [-0.36774984, -4.8380662 , -0.8816923 , ...,  5.62210909,
              -3.03091565, -2.40179902]],
    
            [[ 5.62200599, -5.47362572,  0.59258987, ..., -3.38497517,
              -3.02956429,  4.16206567],
             [ 2.64442396, -3.94671565,  0.30355292, ...,  2.59760619,
               4.12100435, -0.25552282],
             [-2.45275375,  3.77408046, -3.64024118, ...,  0.86100992,
              -0.45383847,  4.55954671],
             ...,
             [ 0.87994107,  2.39608574,  5.68222409, ..., -1.14672809,
               4.51233609,  4.44707278],
             [-0.22920915, -0.69310851,  2.85648251, ...,  0.72224443,
              -0.29348592, -4.36009191],
             [-4.11660356,  4.61058465,  2.54480227, ..., -3.46881524,
              -1.34345756,  3.58326213]]],
    
    
           [[[-4.48297479,  5.37423487, -0.04502174, ...,  1.45438772,
               3.32409781,  5.82965562],
             [-1.68036574,  1.29849335,  5.01786562, ..., -1.92927244,
              -3.13878061, -2.15072818],
             [ 4.93960357, -1.63703437, -0.86140112, ..., -1.42681124,
              -1.38262538,  0.69789152],
             ...,
             [-4.5702245 ,  4.09975119,  4.35163809, ...,  0.82710026,
               5.8240311 ,  0.66717229],
             [ 5.69781085,  4.85598803, -1.55513397, ...,  5.61918348,
               3.4927114 ,  1.66372505],
             [-2.2755498 , -1.82428877,  2.14798935, ...,  2.06921711,
              -2.31827027,  5.60388787]],
    
            [[-5.83462973,  1.34619165, -0.35942852, ...,  0.76806808,
              -4.21323051,  5.69825475],
             [ 4.29751964,  3.3860763 , -3.62821409, ...,  3.57627399,
               3.37048749,  1.72054828],
             [-0.89036435, -0.77470379, -5.10950294, ...,  5.61631698,
               3.83502508,  1.43174228],
             ...,
             [-3.73901542, -2.87528507,  1.11871272, ..., -3.2620852 ,
              -0.82432764,  1.439804  ],
             [-2.06882083, -2.03996198, -3.0427995 , ...,  3.66928704,
               3.54273225, -0.70683439],
             [-3.8647992 ,  3.19216361, -0.4765149 , ...,  1.06426192,
               0.71044147, -5.43914342]],
    
            [[ 0.27633978, -1.88568898, -2.83329481, ...,  1.63764845,
               2.8805911 ,  5.90499614],
             [ 4.04793439, -1.20737822, -4.70838155, ...,  4.34600342,
              -2.99840738,  4.63663994],
             [-0.49077666,  3.97598305,  0.08005033, ..., -3.45798606,
               1.72484702,  0.62944392],
             ...,
             [ 5.64278665, -2.74802136,  2.40769731, ..., -5.48454644,
               3.04316386,  2.96772163],
             [ 3.43690903,  1.75018176, -0.25881595, ...,  5.69149702,
               5.37986604, -1.8092473 ],
             [ 3.56451128, -0.18218212, -4.60953495, ..., -3.83752216,
               0.71538728,  3.7914306 ]],
    
            ...,
    
            [[ 0.18833235, -3.20500322,  5.24469278, ...,  3.19476686,
              -1.73295354,  5.2227745 ],
             [ 3.63353833, -0.50491597,  0.37539667, ..., -4.32527196,
              -2.19252589,  0.88793821],
             [ 4.76334147,  2.67670832,  3.07230686, ..., -1.75110926,
               1.8246358 ,  4.13116446],
             ...,
             [-4.46326822, -2.4800776 ,  1.43713977, ...,  2.70963711,
              -0.88464075, -2.31040336],
             [ 5.31136939, -5.84535334,  3.2341192 , ..., -0.79721415,
              -4.29596117,  0.55826077],
             [-1.6215256 ,  4.9274614 , -4.48512521, ..., -5.92855406,
              -5.88885724,  5.02450651]],
    
            [[-2.34438215, -4.05868296, -4.69983278, ..., -2.22140803,
              -2.06009567, -2.97774715],
             [-5.8045936 ,  1.51341694,  1.42238444, ...,  1.81684906,
               0.03372612, -3.66968061],
             [ 3.67788512, -5.4465478 ,  1.63914948, ..., -5.35317198,
              -0.49703361, -1.69526964],
             ...,
             [-4.30148496, -1.1560039 , -5.53169285, ..., -1.00319453,
              -1.81708018, -5.15218769],
             [ 5.20682718,  3.8875842 , -5.69123109, ..., -3.41510168,
              -3.56915643,  4.70941851],
             [ 4.73155691, -3.64009794, -4.98702746, ..., -4.71644924,
               1.91048944, -4.24707013]],
    
            [[ 0.39321761,  1.44472977, -2.3969932 , ...,  3.77935158,
               1.63239905, -3.26396848],
             [-3.01128647,  1.19735045,  2.95664846, ...,  0.45324647,
               0.47872346,  0.88952057],
             [ 0.43857005,  4.58593787,  3.93237985, ..., -2.75954281,
              -1.09723961, -4.8590797 ],
             ...,
             [-5.08697347,  2.85107997,  4.71206087, ..., -2.76716429,
               5.56844795,  0.27211586],
             [ 5.20928989, -2.80316727, -3.85097358, ...,  1.10303166,
              -4.9108577 , -1.69707045],
             [-4.21566743, -1.14579282, -5.89314146, ...,  1.7635115 ,
              -5.24322234,  3.27161557]]]])>



You can look at the [actual code as it's written in TensorFlow](https://github.com/tensorflow/addons/blob/b9f9ac5cc54c9c2169a8197d0d61adcb42b764e2/tensorflow_addons/layers/normalizations.py#L26). There's a lot more going on there but the basics are the same.


```python

```
